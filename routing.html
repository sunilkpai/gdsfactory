<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Components" href="components.html" /><link rel="prev" title="Workflow" href="component_intro.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.04.07"/>
        <title>Routing - gdsfactory 5.3.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=68f4518137b9aefe99b631505a2064c3c42c9852" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">gdsfactory 5.3.4 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">gdsfactory 5.3.4 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">gdsfactory 5.3.4</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="git.html">Intro Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks/00__git.html">Git: Version control</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/00__python_intro.html">Python intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/00_klayout.html">Klayout integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/vscode.html">VScode</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="notebooks.html">Layout Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks/00_geometry.html">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/01_references.html">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/02_movement.html">Movement</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/03_cells_autoname_and_cache.html">Parametric Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/03_layers.html">Technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/03_waveguides_paths_crossections.html">Paths and cross-sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/04_components_.html">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/04_components_hierarchy.html">Components with hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/04_routing.html">Routing optical and RF ports</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/041_routing_electical.html">Routing electrical</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/05_GDS.html">GDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/07_yaml_component.html">Netlist driven flow (circuits)</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/08_component_circuit_mask.html">Component -&gt; Circuit -&gt; Mask</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/09_mask.html">Mask</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/common_mistakes.html">Common mistakes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="plugins.html">Plugins</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/mpb/001_mpb_waveguide.html">MPB mode-solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/lumerical/1_fdtd_sparameters.html">FDTD Lumerical</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/meep/001_meep_sparameters.html">FDTD Meep</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/meep/002_gratings.html">FDTD Meep gratings</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/tidy3d/00_tidy3d.html">FDTD tidy3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/sax/sax.html">SAX circuit simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/plugins/simphony/01_components.html">Simphony circuit simulator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="component_intro.html">Workflow</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">CHANGELOG</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="routing">
<h1>Routing<a class="headerlink" href="#routing" title="Permalink to this headline">#</a></h1>
<section id="module-gdsfactory.routing.get_route">
<span id="get-route"></span><h2>get_route<a class="headerlink" href="#module-gdsfactory.routing.get_route" title="Permalink to this headline">#</a></h2>
<p><cite>get_route</cite> returns a Manhattan route between two ports.</p>
<p><cite>get_route</cite> only works for an individual routes. For routing groups of ports you need to use <cite>get_bundle</cite> instead</p>
<p>To make a route, you need to supply:</p>
<blockquote>
<div><ul class="simple">
<li><p>input port</p></li>
<li><p>output port</p></li>
<li><p>bend</p></li>
<li><p>straight</p></li>
<li><p>taper to taper to wider straights and reduce straight loss (Optional)</p></li>
</ul>
</div></blockquote>
<p>To generate a straight route:</p>
<blockquote>
<div><p>1. Generate the backbone of the route.
This is a list of manhattan coordinates that the route would pass through
if it used only sharp bends (right angles)</p>
<p>2. Replace the corners by bend references
(with rotation and position computed from the manhattan backbone)</p>
<ol class="arabic simple" start="3">
<li><p>Add tapers if needed and if space permits</p></li>
<li><p>generate straight portions in between tapers or bends</p></li>
</ol>
<p>A <cite>Route</cite> is a dataclass with:</p>
</div></blockquote>
<ul class="simple">
<li><p>references: list of references for tapers, bends and straight waveguides</p></li>
<li><p>ports: a dict of port name to Port, usually two ports “input” and “output”</p></li>
<li><p>length: a float with the length of the route</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_route.get_route">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_route.</span></span><span class="sig-name descname"><span class="pre">get_route</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_route.html#get_route"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_route.get_route" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a Manhattan Route between 2 ports
The references are straights, bends and tapers.
<cite>get_route</cite> is an automatic version of <cite>get_route_from_steps</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_port</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>) – start port.</p></li>
<li><p><strong>output_port</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>) – end port.</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that return bends</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns straights</p></li>
<li><p><strong>taper</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – </p></li>
<li><p><strong>start_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – length of starting straight</p></li>
<li><p><strong>end_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – length of end straight</p></li>
<li><p><strong>min_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – min length of straight for any intermediate segment</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – </p></li>
<li><p><strong>kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s1">'sample_connect'</span><span class="p">)</span>
<span class="n">mmi1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">mmi1x2</span><span class="p">()</span>
<span class="n">mmi2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">mmi1x2</span><span class="p">()</span>
<span class="n">mmi2</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">route</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_route</span><span class="p">(</span><span class="n">mmi1</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o2"</span><span class="p">],</span> <span class="n">mmi2</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o1"</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-1.py">Source code</a>, <a class="reference external" href=".//routing-1.png">png</a>, <a class="reference external" href=".//routing-1.hires.png">hires.png</a>, <a class="reference external" href=".//routing-1.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-1.png" class="plot-directive" src="_images/routing-1.png"/>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_route.get_route_electrical">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_route.</span></span><span class="sig-name descname"><span class="pre">get_route_electrical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">input_port:</span> <span class="pre">gdsfactory.port.Port,</span> <span class="pre">output_port:</span> <span class="pre">gdsfactory.port.Port,</span> <span class="pre">*,</span> <span class="pre">bend:</span> <span class="pre">typing.Union[str,</span> <span class="pre">typing.Callable[[...],</span> <span class="pre">gdsfactory.component.Component],</span> <span class="pre">gdsfactory.component.Component,</span> <span class="pre">typing.Dict[str,</span> <span class="pre">typing.Any]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">wire_corner&gt;,</span> <span class="pre">straight:</span> <span class="pre">typing.Union[str,</span> <span class="pre">typing.Callable[[...],</span> <span class="pre">gdsfactory.component.Component],</span> <span class="pre">gdsfactory.component.Component,</span> <span class="pre">typing.Dict[str,</span> <span class="pre">typing.Any]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">straight&gt;,</span> <span class="pre">taper:</span> <span class="pre">typing.Optional[typing.Union[str,</span> <span class="pre">typing.Callable[[...],</span> <span class="pre">gdsfactory.component.Component],</span> <span class="pre">gdsfactory.component.Component,</span> <span class="pre">typing.Dict[str,</span> <span class="pre">typing.Any]]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">start_straight_length:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">end_straight_length:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">min_straight_length:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">2.0,</span> <span class="pre">cross_section:</span> <span class="pre">typing.Union[str,</span> <span class="pre">typing.Callable[[...],</span> <span class="pre">gdsfactory.cross_section.CrossSection],</span> <span class="pre">gdsfactory.cross_section.CrossSection,</span> <span class="pre">typing.Dict[str,</span> <span class="pre">typing.Any]]</span> <span class="pre">=</span> <span class="pre">functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;,</span> <span class="pre">layer=(49,</span> <span class="pre">0),</span> <span class="pre">width=10.0,</span> <span class="pre">port_names=('e1',</span> <span class="pre">'e2'),</span> <span class="pre">port_types=('electrical',</span> <span class="pre">'electrical')),</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">gdsfactory.types.Route</span></span></span><a class="headerlink" href="#gdsfactory.routing.get_route.get_route_electrical" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a Manhattan Route between 2 ports
The references are straights, bends and tapers.
<cite>get_route</cite> is an automatic version of <cite>get_route_from_steps</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_port</strong> – start port.</p></li>
<li><p><strong>output_port</strong> – end port.</p></li>
<li><p><strong>bend</strong> – function that return bends</p></li>
<li><p><strong>straight</strong> – function that returns straights</p></li>
<li><p><strong>taper</strong> – </p></li>
<li><p><strong>start_straight_length</strong> – length of starting straight</p></li>
<li><p><strong>end_straight_length</strong> – length of end straight</p></li>
<li><p><strong>min_straight_length</strong> – min length of straight for any intermediate segment</p></li>
<li><p><strong>cross_section</strong> – </p></li>
<li><p><strong>kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s1">'sample_connect'</span><span class="p">)</span>
<span class="n">mmi1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">mmi1x2</span><span class="p">()</span>
<span class="n">mmi2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">mmi1x2</span><span class="p">()</span>
<span class="n">mmi2</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">route</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_route</span><span class="p">(</span><span class="n">mmi1</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o2"</span><span class="p">],</span> <span class="n">mmi2</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o1"</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-2.py">Source code</a>, <a class="reference external" href=".//routing-2.png">png</a>, <a class="reference external" href=".//routing-2.hires.png">hires.png</a>, <a class="reference external" href=".//routing-2.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-2.png" class="plot-directive" src="_images/routing-2.png"/>
</figure>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_route.get_route_from_waypoints">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_route.</span></span><span class="sig-name descname"><span class="pre">get_route_from_waypoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waypoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper=&lt;function</span> <span class="pre">taper&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_route.html#get_route_from_waypoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_route.get_route_from_waypoints" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a route formed by the given waypoints with
bends instead of corners and optionally tapers in straight sections.
Tapering to wider straights reduces the optical loss.
<cite>get_route_from_waypoints</cite> is a manual version of <cite>get_route</cite>
<cite>get_route_from_steps</cite> is a  more concise and convenient version of
<cite>get_route_from_waypoints</cite> also available in gf.routing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>waypoints</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]) – Coordinates that define the route</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – function that returns bends</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – function that returns straight waveguides</p></li>
<li><p><strong>taper</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]) – function that returns tapers</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – </p></li>
<li><p><strong>kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s2">"waypoints_sample"</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">straight</span><span class="p">()</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>

<span class="n">obstacle</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">obstacle1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">obstacle</span>
<span class="n">obstacle2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">obstacle</span>
<span class="n">obstacle1</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">obstacle2</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="mi">25</span>


<span class="n">p0x</span><span class="p">,</span> <span class="n">p0y</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o2"</span><span class="p">]</span><span class="o">.</span><span class="n">midpoint</span>
<span class="n">p1x</span><span class="p">,</span> <span class="n">p1y</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s2">"o2"</span><span class="p">]</span><span class="o">.</span><span class="n">midpoint</span>
<span class="n">o</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># vertical offset to overcome bottom obstacle</span>
<span class="n">ytop</span> <span class="o">=</span> <span class="mi">20</span>


<span class="n">routes</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_route_from_waypoints</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="n">p0x</span><span class="p">,</span> <span class="n">p0y</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p0x</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span> <span class="n">p0y</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p0x</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span> <span class="n">ytop</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p1x</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span> <span class="n">ytop</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p1x</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span> <span class="n">p1y</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p1x</span><span class="p">,</span> <span class="n">p1y</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">routes</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-3.py">Source code</a>, <a class="reference external" href=".//routing-3.png">png</a>, <a class="reference external" href=".//routing-3.hires.png">hires.png</a>, <a class="reference external" href=".//routing-3.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-3.png" class="plot-directive" src="_images/routing-3.png"/>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-gdsfactory.routing.get_route_from_steps">
<span id="get-route-from-steps"></span><h2>get_route_from_steps<a class="headerlink" href="#module-gdsfactory.routing.get_route_from_steps" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_route_from_steps.get_route_from_steps">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_route_from_steps.</span></span><span class="sig-name descname"><span class="pre">get_route_from_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend='bend_euler'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight='straight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper='taper'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_route_from_steps.html#get_route_from_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_route_from_steps.get_route_from_steps" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a route formed by the given waypoints steps
bends instead of corners and optionally tapers in straight sections.
Tapering to wider straights reduces the optical loss.
<cite>get_route_from_steps</cite> is a manual version of <cite>get_route</cite>
and a more concise and convenient version of <cite>get_route_from_waypoints</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>) – start port</p></li>
<li><p><strong>port2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>) – end port</p></li>
<li><p><strong>steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]]) – changes that define the route [{‘dx’: 5}, {‘dy’: 10}]</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns bends</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns straight waveguides</p></li>
<li><p><strong>taper</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – function that returns tapers</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – </p></li>
<li><p><strong>**kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s2">"get_route_from_steps_sample"</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">straight</span><span class="p">()</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>

<span class="n">obstacle</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">obstacle1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">obstacle</span>
<span class="n">obstacle2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">obstacle</span>
<span class="n">obstacle1</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">obstacle2</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s1">'o2'</span><span class="p">]</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s1">'o2'</span><span class="p">]</span>
<span class="n">route</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_route_from_steps</span><span class="p">(</span>
    <span class="n">port1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span>
    <span class="n">port2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">"x"</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"y"</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"x"</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"y"</span><span class="p">:</span> <span class="mi">80</span><span class="p">},</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-4.py">Source code</a>, <a class="reference external" href=".//routing-4.png">png</a>, <a class="reference external" href=".//routing-4.hires.png">hires.png</a>, <a class="reference external" href=".//routing-4.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-4.png" class="plot-directive" src="_images/routing-4.png"/>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_route_from_steps.get_route_from_steps_electrical">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_route_from_steps.</span></span><span class="sig-name descname"><span class="pre">get_route_from_steps_electrical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gdsfactory.port.Port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gdsfactory.port.Port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><span class="pre">gdsfactory.component.Component</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><span class="pre">gdsfactory.component.Component</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'wire_corner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><span class="pre">gdsfactory.component.Component</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><span class="pre">gdsfactory.component.Component</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'straight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><span class="pre">gdsfactory.component.Component</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><span class="pre">gdsfactory.component.Component</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><span class="pre">gdsfactory.cross_section.CrossSection</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><span class="pre">gdsfactory.cross_section.CrossSection</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'metal3'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">gdsfactory.types.Route</span></span></span><a class="headerlink" href="#gdsfactory.routing.get_route_from_steps.get_route_from_steps_electrical" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a route formed by the given waypoints steps
bends instead of corners and optionally tapers in straight sections.
Tapering to wider straights reduces the optical loss.
<cite>get_route_from_steps</cite> is a manual version of <cite>get_route</cite>
and a more concise and convenient version of <cite>get_route_from_waypoints</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port1</strong> – start port</p></li>
<li><p><strong>port2</strong> – end port</p></li>
<li><p><strong>steps</strong> – changes that define the route [{‘dx’: 5}, {‘dy’: 10}]</p></li>
<li><p><strong>bend</strong> – function that returns bends</p></li>
<li><p><strong>straight</strong> – function that returns straight waveguides</p></li>
<li><p><strong>taper</strong> – function that returns tapers</p></li>
<li><p><strong>cross_section</strong> – </p></li>
<li><p><strong>**kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s2">"get_route_from_steps_sample"</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">straight</span><span class="p">()</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>

<span class="n">obstacle</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">port_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">obstacle1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">obstacle</span>
<span class="n">obstacle2</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">obstacle</span>
<span class="n">obstacle1</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">obstacle2</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s1">'o2'</span><span class="p">]</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">ports</span><span class="p">[</span><span class="s1">'o2'</span><span class="p">]</span>
<span class="n">route</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_route_from_steps</span><span class="p">(</span>
    <span class="n">port1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span>
    <span class="n">port2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">"x"</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"y"</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"x"</span><span class="p">:</span> <span class="mi">120</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"y"</span><span class="p">:</span> <span class="mi">80</span><span class="p">},</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-5.py">Source code</a>, <a class="reference external" href=".//routing-5.png">png</a>, <a class="reference external" href=".//routing-5.hires.png">hires.png</a>, <a class="reference external" href=".//routing-5.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-5.png" class="plot-directive" src="_images/routing-5.png"/>
</figure>
</dd></dl>
</section>
<section id="get-bundle">
<h2>get_bundle<a class="headerlink" href="#get-bundle" title="Permalink to this headline">#</a></h2>
<p>Often, several ports have to be linked together without them crossing each other. One way to tackle
simple cases is to use bundle routing. Several functions are available depending on the use case:</p>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle.get_bundle">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle.</span></span><span class="sig-name descname"><span class="pre">get_bundle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension_length=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_ports=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section='strip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle.html#get_bundle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle.get_bundle" title="Permalink to this definition">#</a></dt>
<dd><p>Connects a bundle of ports with a river router.
Chooses the correct u_bundle to use based on port angles
ports1 and ports2 should all be facing in the same direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of starting ports.</p></li>
<li><p><strong>ports2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of end ports.</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – bundle separation (center to center).</p></li>
<li><p><strong>extension_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – adds straight extension.</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function for the bend. Defaults to euler.</p></li>
<li><p><strong>sort_ports</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – sort port coordinates.</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – CrossSection or function that returns a cross_section.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>width</strong> – main layer waveguide width (um).</p></li>
<li><p><strong>layer</strong> – main layer for waveguide.</p></li>
<li><p><strong>layer_bbox</strong> – optional bounding box layer for device recognition. (68, 0)</p></li>
<li><p><strong>width_wide</strong> – wide waveguides width (um) for low loss routing.</p></li>
<li><p><strong>auto_widen</strong> – taper to wide waveguides for low loss routing.</p></li>
<li><p><strong>auto_widen_minimum_length</strong> – minimum straight length for auto_widen.</p></li>
<li><p><strong>taper_length</strong> – taper_length for auto_widen.</p></li>
<li><p><strong>bbox_layers</strong> – list of layers for rectangular bounding box.</p></li>
<li><p><strong>bbox_offsets</strong> – list of bounding box offsets.</p></li>
<li><p><strong>radius</strong> – bend radius (um).</p></li>
<li><p><strong>sections</strong> – list of Sections(width, offset, layer, ports).</p></li>
<li><p><strong>port_names</strong> – for input and output (‘o1’, ‘o2’).</p></li>
<li><p><strong>port_types</strong> – for input and output: electrical, optical, vertical_te …</p></li>
<li><p><strong>min_length</strong> – defaults to 1nm = 10e-3um for routing.</p></li>
<li><p><strong>start_straight_length</strong> – straight length at the beginning of the route.</p></li>
<li><p><strong>end_straight_length</strong> – end length at the beginning of the route.</p></li>
<li><p><strong>snap_to_grid</strong> – can snap points to grid when extruding the path.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
</dl>
</dd></dl>
<p>Example with two arrays of ports connected using <cite>get_bundle</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="nd">@gf</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span> <span class="nf">test_north_to_south</span><span class="p">():</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">200.0</span>
    <span class="n">xs1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">650</span><span class="p">]</span>

    <span class="n">pitch</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs1</span><span class="p">)</span>
    <span class="n">xs2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">pitch</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span>
    <span class="n">xs2</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">400</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">pitch</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="mi">90</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="mi">180</span>

    <span class="n">ports1</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s2">"top_</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">xs1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">ports2</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="s2">"bottom_</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">xs2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dy</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
    <span class="n">routes</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_bundle</span><span class="p">(</span><span class="n">ports1</span><span class="p">,</span> <span class="n">ports2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">routes</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>


<span class="n">c</span> <span class="o">=</span> <span class="n">test_north_to_south</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-6.py">Source code</a>)</p>
<p><cite>get bundle</cite> is the generic river routing function that will call different function depending on
the port orientation. Get bundle acts as a high level entry point. Based on the angle
configurations of the banks of ports, it decides which sub-routine to call:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>get_bundle_same_axis</cite>, banks or ports facing each other (but with arbitrary and varying pitch
on each side)</p></li>
<li><p><cite>get_bundle_corner</cite>, banks of ports with 90Deg / 270Deg between them (again pitch is flexible on
both sides)</p></li>
<li><p><cite>get_bundle_udirect</cite>, banks of ports with direct U-turns</p></li>
<li><p><cite>get_bundle_uindirect</cite>, banks of ports with indirect U-turns</p></li>
</ul>
<p>Or you can also call each functions individually</p>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle.get_bundle_same_axis">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle.</span></span><span class="sig-name descname"><span class="pre">get_bundle_same_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_straight_length=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_straight_length=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_ports=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle.html#get_bundle_same_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle.get_bundle_same_axis" title="Permalink to this definition">#</a></dt>
<dd><p>Semi auto-routing for two lists of ports.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – first list of ports</p></li>
<li><p><strong>ports2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – second list of ports</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – minimum separation between two straights</p></li>
<li><p><strong>axis</strong> – specifies “X” or “Y”
X (resp. Y) -&gt; indicates that the ports should be sorted and
compared using the X (resp. Y) axis</p></li>
<li><p><strong>route_filter</strong> – filter to apply to the manhattan waypoints
e.g <cite>get_route_from_waypoints</cite> for deep etch strip straight</p></li>
<li><p><strong>end_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – offset to add at the end of each straight</p></li>
<li><p><strong>sort_ports</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – sort the ports according to the axis.</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – CrossSection or function that returns a cross_section.</p></li>
<li><p><strong>kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>[route_filter(r) for r in routes]</cite> list of lists of coordinates
e.g with default <cite>get_route_from_waypoints</cite>,
returns a list of elements which can be added to a component</p>
</dd>
</dl>
<p>The routing assumes manhattan routing between the different ports.
The strategy is to modify <cite>start_straight</cite> and <cite>end_straight</cite> for each
straight such that straights do not collide.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>             <span class="n">X</span>    <span class="n">X</span>     <span class="n">X</span>  <span class="n">X</span> <span class="n">X</span>  <span class="n">X</span>
<span class="o">|-----------|</span>    <span class="o">|</span>     <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>  <span class="o">|-----------------------|</span>
<span class="o">|</span>          <span class="o">|-----|</span>     <span class="o">|</span>  <span class="o">|</span> <span class="o">|---------------|</span>          <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>          <span class="o">||</span>  <span class="o">|------|</span>          <span class="o">|</span>          <span class="o">|</span>
<span class="mi">2</span> <span class="n">X</span>          <span class="n">X</span>          <span class="n">X</span>          <span class="n">X</span>          <span class="n">X</span>          <span class="n">X</span>
</pre></div>
</div>
<p>ports1: at the top
ports2: at the bottom</p>
<p>The general strategy is:
Group tracks which would collide together and apply the following method
on each group:</p>
<blockquote>
<div><dl class="simple">
<dt>if x2 &gt;= x1, increase <code class="docutils literal notranslate"><span class="pre">end_straight</span></code></dt><dd><p>(as seen on the right 3 ports)</p>
</dd>
<dt>otherwise, decrease <code class="docutils literal notranslate"><span class="pre">end_straight</span></code></dt><dd><p>(as seen on the first 2 ports)</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>We deal with negative end_straight by doing at the end</dt><dd><p>end_straights = end_straights - min(end_straights)</p>
</dd>
</dl>
<p>This method deals with different metal track/wg/wire widths too.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle_corner.get_bundle_corner">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle_corner.</span></span><span class="sig-name descname"><span class="pre">get_bundle_corner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_filter=&lt;function</span> <span class="pre">get_route_from_waypoints&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle_corner.html#get_bundle_corner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle_corner.get_bundle_corner" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of start ports</p></li>
<li><p><strong>ports2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of end ports</p></li>
<li><p><strong>route_filter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]) – filter to apply to the manhattan waypoints
e.g <cite>get_route_from_waypoints</cite> for deep etch strip straight</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>[route_filter(r) for r in routes]</cite> where routes is a list of lists of coordinates
e.g with default <cite>get_route_from_waypoints</cite>, returns a list of elements which can be added to a component</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bend</span><span class="o">-</span><span class="n">types</span>

<span class="mi">90</span> <span class="n">Deg</span> <span class="n">bend</span>
           <span class="n">A1</span> <span class="n">A2</span>      <span class="n">AN</span>
           <span class="o">|</span> <span class="o">|</span>  <span class="o">...</span>  <span class="o">|</span>
           <span class="o">|</span> <span class="o">|</span>      <span class="o">/</span>
          <span class="o">/</span> <span class="o">/</span>      <span class="o">/</span>
         <span class="o">/</span> <span class="o">/</span>      <span class="o">/</span>
  <span class="n">B1</span> <span class="o">----/</span> <span class="o">/</span>    <span class="n">_</span><span class="o">/</span>
  <span class="n">B2</span> <span class="o">-----/</span>     <span class="o">/</span>
               <span class="o">/</span>
    <span class="o">...</span>      <span class="n">_</span><span class="o">/</span>
  <span class="n">BN</span> <span class="o">--------/</span>


<span class="mi">270</span> <span class="n">Deg</span> <span class="n">bend</span>
    <span class="o">/------------</span>\
   <span class="o">/</span>              \
  <span class="o">/</span>  <span class="o">/-------</span>\     \
 <span class="o">/</span>  <span class="o">/</span>         \     \
<span class="o">|</span>  <span class="o">/</span>   <span class="o">/--</span>\    <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span> <span class="o">/</span>  <span class="o">/</span>   <span class="o">|</span>     <span class="o">|</span> <span class="o">...|</span>
<span class="o">|</span> <span class="o">|</span> <span class="o">/</span>    <span class="n">B1</span>    <span class="n">B2</span>   <span class="n">BN</span>
<span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
<span class="o">|</span> \ \<span class="o">---</span> <span class="n">A1</span>
<span class="o">|</span>  <span class="o">-----</span> <span class="n">A2</span>
<span class="o">|</span>    <span class="o">...</span>
 \<span class="o">------</span> <span class="n">AN</span>
</pre></div>
</div>
<p>Connect banks of ports with either 90Deg or 270Deg angle between them</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle_u.get_bundle_udirect">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle_u.</span></span><span class="sig-name descname"><span class="pre">get_bundle_udirect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_filter=&lt;function</span> <span class="pre">get_route_from_waypoints&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**routing_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle_u.html#get_bundle_udirect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle_u.get_bundle_udirect" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of start ports</p></li>
<li><p><strong>ports2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of end ports</p></li>
<li><p><strong>route_filter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – filter to apply to the manhattan waypoints
e.g <cite>get_route_from_waypoints</cite> for deep etch strip straight</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – between straights</p></li>
<li><p><strong>start_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – </p></li>
<li><p><strong>end_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – </p></li>
<li><p><strong>start_straight_offset</strong> – </p></li>
<li><p><strong>end_straight_offset</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[route_filter(r) for r in routes] where routes is a list of lists of coordinates
e.g with default <cite>get_route_from_waypoints</cite>,
returns list of elements which can be added to a component</p>
</dd>
</dl>
<p>Used for routing multiple ports back to a bundled input in a component</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">:</span> <span class="n">start</span> <span class="n">ports</span>
<span class="n">D</span><span class="p">:</span> <span class="n">End</span> <span class="n">ports</span>

<span class="n">On</span> <span class="n">this</span> <span class="n">example</span> <span class="n">bellow</span><span class="p">,</span> <span class="n">the</span> <span class="n">axis</span> <span class="ow">is</span> <span class="n">along</span> <span class="n">X</span>

                   <span class="n">X</span><span class="o">------</span>\
                          <span class="o">|</span>
                   <span class="n">X</span><span class="o">----</span>\ <span class="o">|</span>
                  <span class="o">...</span>   <span class="o">|</span> <span class="o">|</span>
                   <span class="n">X</span><span class="o">--</span>\ <span class="o">|</span> <span class="o">|</span>
                      <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
  <span class="n">D</span><span class="o">-------------------/</span> <span class="o">|</span> <span class="o">|</span>
  <span class="o">...</span>                   <span class="o">|</span> <span class="o">|</span>
  <span class="n">D</span><span class="o">---------------------/</span> <span class="o">|</span>
  <span class="n">D</span><span class="o">-----------------------</span>
  <span class="n">D</span><span class="o">-----------------------</span>\
  <span class="n">D</span><span class="o">---------------------</span>\ <span class="o">|</span>
  <span class="o">...</span>                   <span class="o">|</span> <span class="o">|</span>
  <span class="n">D</span><span class="o">-------------------</span>\ <span class="o">|</span> <span class="o">|</span>
                      <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
                   <span class="n">X</span><span class="o">--/</span> <span class="o">|</span> <span class="o">|</span>
                  <span class="o">...</span>   <span class="o">|</span> <span class="o">|</span>
                   <span class="n">X</span><span class="o">----/</span> <span class="o">|</span>
                          <span class="o">|</span>
                   <span class="n">X</span><span class="o">------/</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle_u.get_bundle_uindirect">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle_u.</span></span><span class="sig-name descname"><span class="pre">get_bundle_uindirect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_filter=&lt;function</span> <span class="pre">get_route_from_waypoints&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension_length=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_straight_length=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**routing_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle_u.html#get_bundle_uindirect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle_u.get_bundle_uindirect" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> – list of start ports</p></li>
<li><p><strong>ports2</strong> – list of end ports</p></li>
<li><p><strong>route_filter</strong> – filter to apply to the manhattan waypoints
e.g <cite>get_route_from_waypoints</cite> for deep etch strip straight</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – center to center waveguide spacing</p></li>
<li><p><strong>extension_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – </p></li>
<li><p><strong>start_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – extends</p></li>
<li><p><strong>end_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of routes, where each route has references, ports and length</p>
</dd>
</dl>
<p>Used for routing multiple ports back to a bundled input in a component</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">:</span> <span class="n">start</span> <span class="n">ports</span>
<span class="n">D</span><span class="p">:</span> <span class="n">End</span> <span class="n">ports</span>


                            <span class="n">X</span><span class="o">------</span>
                            <span class="n">X</span><span class="o">----</span>  <span class="o">|</span>
                           <span class="o">...</span>   <span class="o">|</span> <span class="o">|</span>
                            <span class="n">X</span><span class="o">--</span>\ <span class="o">|</span> <span class="o">|</span>
                               <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
    <span class="o">/--------------------------/</span> <span class="o">|</span> <span class="o">|</span>
    <span class="o">|</span>                            <span class="o">|</span> <span class="o">|</span>
    <span class="o">|</span> <span class="o">/--------------------------/</span> <span class="o">|</span>
    <span class="o">|</span> <span class="o">|</span>                            <span class="o">|</span>
    <span class="o">|</span> <span class="o">|</span> <span class="o">/--------------------------/</span>
    <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
    <span class="o">|</span> <span class="o">|</span> \<span class="o">--</span><span class="n">D</span>
    <span class="o">|</span> \<span class="o">----</span><span class="n">D</span>
    <span class="o">|</span>     <span class="o">...</span>
    \<span class="o">------</span><span class="n">D</span>
    <span class="o">/------</span><span class="n">D</span>
    <span class="o">|</span>     <span class="o">...</span>
    <span class="o">|</span> <span class="o">/----</span><span class="n">D</span>
    <span class="o">|</span> <span class="o">|</span> <span class="o">/--</span><span class="n">D</span>
    <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
    <span class="o">|</span> <span class="o">|</span> \<span class="o">--------------------------</span>
    <span class="o">|</span> <span class="o">|</span>                            <span class="o">|</span>
    <span class="o">|</span> \<span class="o">--------------------------</span>\ <span class="o">|</span>
    <span class="o">|</span>                            <span class="o">|</span> <span class="o">|</span>
    \<span class="o">--------------------------</span>\ <span class="o">|</span> <span class="o">|</span>
                               <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
                            <span class="n">X</span><span class="o">--/</span> <span class="o">|</span> <span class="o">|</span>
                           <span class="o">...</span>   <span class="o">|</span> <span class="o">|</span>
                            <span class="n">X</span><span class="o">----/</span> <span class="o">|</span>
                            <span class="n">X</span><span class="o">------/</span>
<span class="s1">'''</span>
</pre></div>
</div>
</dd></dl>
</section>
<section id="get-bundle-from-steps">
<h2>get_bundle_from_steps<a class="headerlink" href="#get-bundle-from-steps" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle_from_steps.get_bundle_from_steps">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle_from_steps.</span></span><span class="sig-name descname"><span class="pre">get_bundle_from_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper=&lt;function</span> <span class="pre">taper&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section='strip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_ports=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle_from_steps.html#get_bundle_from_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle_from_steps.get_bundle_from_steps" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a list of routes formed by the given waypoints steps
bends instead of corners and optionally tapers in straight sections.
Tapering to wider straights reduces the optical loss and phase errors.
<cite>get_bundle_from_steps</cite> is a manual version of <cite>get_bundle</cite>
and a more convenient version of <cite>get_bundle_from_waypoints</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>port1</strong> – start ports (list or dict)</p></li>
<li><p><strong>port2</strong> – end ports (list or dict)</p></li>
<li><p><strong>steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]]) – changes that define the route [{‘dx’: 5}, {‘dy’: 10}]</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns bends</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns straight waveguides</p></li>
<li><p><strong>taper</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – function that returns tapers</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – for routes</p></li>
<li><p><strong>sort_ports</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True sort ports</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – center to center, defaults to ports1 separation</p></li>
<li><p><strong>kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s2">"get_route_from_steps_sample"</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="n">gf</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">straight</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">w</span>
<span class="n">right</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">get_ports_list</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">get_ports_list</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">routes</span> <span class="o">=</span> <span class="n">get_bundle_from_steps</span><span class="p">(</span>
    <span class="n">p1</span><span class="p">,</span>
    <span class="n">p2</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[{</span><span class="s2">"x"</span><span class="p">:</span> <span class="mi">150</span><span class="p">}],</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">routes</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-7.py">Source code</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="route-ports-to-side">
<h2>route_ports_to_side<a class="headerlink" href="#route-ports-to-side" title="Permalink to this headline">#</a></h2>
<p>For now <cite>get_bundle</cite> is not smart enough to decide whether it should call <cite>route_ports_to_side</cite>.
So you either need to connect your ports to face in one direction first, or to
use <cite>route_ports_to_side</cite> before calling <cite>get_bundle</cite></p>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.route_ports_to_side.route_ports_to_side">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.route_ports_to_side.</span></span><span class="sig-name descname"><span class="pre">route_ports_to_side</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side='north'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routing_func=&lt;function</span> <span class="pre">get_route&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/route_ports_to_side.html#route_ports_to_side"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.route_ports_to_side.route_ports_to_side" title="Permalink to this definition">#</a></dt>
<dd><p>Routes ports to a given side</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ComponentReference</span></code>]) – list/dict/Component/ComponentReference to route to a side.</p></li>
<li><p><strong>side</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – ‘north’, ‘south’, ‘east’ or ‘west’.</p></li>
<li><p><strong>x</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – position to route ports for east/west. None, uses most east/west value</p></li>
<li><p><strong>y</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – position to route ports for south/north. None, uses most north/south value</p></li>
<li><p><strong>routing_func</strong> – the routing function. By default uses <cite>get_route</cite></p></li>
<li><p><strong>kwargs</strong> – radius
separation
extend_bottom/extend_top for east/west routing
extend_left, extend_right for south/north routing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of ports:</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List of routes</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="get-bundle-from-waypoints">
<h2>get_bundle_from_waypoints<a class="headerlink" href="#get-bundle-from-waypoints" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle_from_waypoints.get_bundle_from_waypoints">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle_from_waypoints.</span></span><span class="sig-name descname"><span class="pre">get_bundle_from_waypoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waypoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper=&lt;function</span> <span class="pre">taper&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_ports=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_route_error=&lt;function</span> <span class="pre">get_route_error&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle_from_waypoints.html#get_bundle_from_waypoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle_from_waypoints.get_bundle_from_waypoints" title="Permalink to this definition">#</a></dt>
<dd><p>Returns list of routes that connect bundle of ports with bundle of routes
where routes follow a list of waypoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of ports</p></li>
<li><p><strong>ports2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of ports</p></li>
<li><p><strong>waypoints</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]) – list of points defining a route</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns straights</p></li>
<li><p><strong>taper</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns tapers</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – function that returns bends</p></li>
<li><p><strong>sort_ports</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – sorts ports</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – cross_section</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – center to center, defaults to ports1 separation</p></li>
<li><p><strong>**kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
</dl>
</dd></dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>


<span class="nd">@gf</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span> <span class="nf">test_connect_bundle_waypoints</span><span class="p">():</span>
    <span class="sd">"""Connect bundle of ports with bundle of routes following a list of waypoints."""</span>
    <span class="n">xs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">-</span> <span class="mf">500.0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">xs1</span><span class="o">.</span><span class="n">size</span>
    <span class="n">ys2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span> <span class="o">+</span> <span class="mf">500.0</span>

    <span class="n">ports1</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="sa">f</span><span class="s2">"A_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="p">(</span><span class="n">xs1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">ports2</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="sa">f</span><span class="s2">"B_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ys2</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
    <span class="n">waypoints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">),</span>
        <span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">),</span>
        <span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">350</span><span class="p">),</span>
        <span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="o">-</span><span class="mi">350</span><span class="p">),</span>
        <span class="p">(</span><span class="n">ports1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">400</span><span class="p">,</span> <span class="n">ports2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">routes</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_bundle_from_waypoints</span><span class="p">(</span><span class="n">ports1</span><span class="p">,</span> <span class="n">ports2</span><span class="p">,</span> <span class="n">waypoints</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">routes</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span>

<span class="n">cell</span> <span class="o">=</span> <span class="n">test_connect_bundle_waypoints</span><span class="p">()</span>
<span class="n">cell</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-8.py">Source code</a>)</p>
</section>
<section id="get-bundle-path-length-match">
<h2>get_bundle_path_length_match<a class="headerlink" href="#get-bundle-path-length-match" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.get_bundle_path_length_match.get_bundle_path_length_match">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.get_bundle_path_length_match.</span></span><span class="sig-name descname"><span class="pre">get_bundle_path_length_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ports1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ports2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation=30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_straight_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_length=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_loops=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modify_segment_i=-2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper=&lt;function</span> <span class="pre">taper&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_straight_length=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_filter=&lt;function</span> <span class="pre">get_route_from_waypoints&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_ports=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/get_bundle_path_length_match.html#get_bundle_path_length_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.get_bundle_path_length_match.get_bundle_path_length_match" title="Permalink to this definition">#</a></dt>
<dd><p>Returns list of routes that are path length matched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ports1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of ports</p></li>
<li><p><strong>ports2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Port</span></code>]) – list of ports</p></li>
<li><p><strong>separation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – between the loops</p></li>
<li><p><strong>end_straight_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – if None tries to determine it</p></li>
<li><p><strong>extra_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – distance added to all path length compensation.
Useful is we want to add space for extra taper on all branches</p></li>
<li><p><strong>nb_loops</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of extra loops added in the path</p></li>
<li><p><strong>modify_segment_i</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – index of the segment that accomodates the new turns
default is next to last segment</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – for bends</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – for straights</p></li>
<li><p><strong>taper</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – </p></li>
<li><p><strong>start_straight_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – </p></li>
<li><p><strong>route_filter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – get_route_from_waypoints</p></li>
<li><p><strong>sort_ports</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – sorts ports before routing</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – factory</p></li>
<li><p><strong>**kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<p>Tips:</p>
<ul class="simple">
<li><p>If path length matches the wrong segments, change <cite>modify_segment_i</cite> arguments.</p></li>
<li><p>Adjust <cite>nb_loops</cite> to avoid too short or too long segments</p></li>
<li><p>Adjust <cite>separation</cite> and <cite>end_straight_offset</cite> to avoid compensation collisions</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Component</span><span class="p">(</span><span class="s2">"path_length_match_sample"</span><span class="p">)</span>

<span class="n">dy</span> <span class="o">=</span> <span class="mf">2000.0</span>
<span class="n">xs1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">650</span><span class="p">]</span>
<span class="n">pitch</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs1</span><span class="p">)</span>
<span class="n">xs2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">pitch</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

<span class="n">a1</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="mi">180</span>
<span class="n">ports1</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="sa">f</span><span class="s2">"top_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="p">(</span><span class="n">xs1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">ports2</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="o">.</span><span class="n">Port</span><span class="p">(</span><span class="sa">f</span><span class="s2">"bottom_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="p">(</span><span class="n">xs2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dy</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

<span class="n">routes</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">get_bundle_path_length_match</span><span class="p">(</span>
    <span class="n">ports1</span><span class="p">,</span> <span class="n">ports2</span><span class="p">,</span> <span class="n">extra_length</span><span class="o">=</span><span class="mi">44</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">routes</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">route</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-9.py">Source code</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code>]</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="add-fiber-array-add-fiber-single">
<h2>add_fiber_array / add_fiber_single<a class="headerlink" href="#add-fiber-array-add-fiber-single" title="Permalink to this headline">#</a></h2>
<p>In cases where individual components have to be tested, you can generate the array of optical I/O
and connect them to the component.</p>
<p>You can connect the waveguides to a 127um pitch fiber array.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.add_fiber_array.add_fiber_array">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.add_fiber_array.</span></span><span class="sig-name descname"><span class="pre">add_fiber_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component='mmi2x2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grating_coupler=functools.partial(&lt;function</span> <span class="pre">grating_coupler_elliptical_trenches&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization='te'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_angle=35)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gc_port_name='o1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gc_port_labels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_ports=functools.partial(&lt;function</span> <span class="pre">select_ports&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port_type='optical')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section=functools.partial(&lt;cyfunction</span> <span class="pre">cross_section&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_input_labels_function=&lt;function</span> <span class="pre">get_input_labels&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_label=(66</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/add_fiber_array.html#add_fiber_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.add_fiber_array.add_fiber_array" title="Permalink to this definition">#</a></dt>
<dd><p>Returns component with optical IO (tapers, south routes and grating_couplers).
adds a grating_coupler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – component or component function to connect to grating couplers.</p></li>
<li><p><strong>grating_coupler</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]]]) – fiber coupler instance, function or list of functions.</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – straight function.</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – bend function.</p></li>
<li><p><strong>gc_port_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – grating coupler input port name.</p></li>
<li><p><strong>gc_port_labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]]) – grating coupler list of labels.</p></li>
<li><p><strong>component_name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – for the label.</p></li>
<li><p><strong>select_ports</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – function to select ports.</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – cross_section function.</p></li>
<li><p><strong>layer_label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – LAYER.LABEL</p></li>
<li><p><strong>get_input_labels_function</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]) – function to get input labels for grating couplers.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>taper</strong> – taper function name or dict.</p></li>
<li><p><strong>get_input_label_text_loopback_function</strong> – function to get input label test.</p></li>
<li><p><strong>get_input_label_text_function.</strong> – </p></li>
<li><p><strong>straight</strong> – straight.</p></li>
<li><p><strong>fanout_length</strong> – None  # if None, automatic calculation of fanout length</p></li>
<li><p><strong>max_y0_optical</strong> – None.</p></li>
<li><p><strong>with_loopback</strong> – True, adds loopback structures</p></li>
<li><p><strong>straight_separation</strong> – 4.0.</p></li>
<li><p><strong>list_port_labels</strong> – None, adds TM labels to port indices in this list.</p></li>
<li><p><strong>connected_port_list_ids</strong> – None # only for type 0 optical routing</p></li>
<li><p><strong>nb_optical_ports_lines</strong> – 1</p></li>
<li><p><strong>force_manhattan</strong> – False</p></li>
<li><p><strong>excluded_ports</strong> – list of ports to exclude from adding fiber coupler.</p></li>
<li><p><strong>grating_indices</strong> – list of grating coupler indices.</p></li>
<li><p><strong>routing_straight</strong> – None</p></li>
<li><p><strong>routing_method</strong> – get_route</p></li>
<li><p><strong>optical_routing_type</strong> – None: auto, 0: no extension, 1: standard, 2: check</p></li>
<li><p><strong>gc_rotation</strong> – fiber coupler rotation in degrees. Defaults to -90.</p></li>
<li><p><strong>input_port_indexes</strong> – [0]</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>
<span class="n">gf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_plot_options</span><span class="p">(</span><span class="n">show_subports</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">crossing</span><span class="p">()</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">add_fiber_array</span><span class="p">(</span>
    <span class="n">component</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
    <span class="n">optical_routing_type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">grating_coupler</span><span class="o">=</span><span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">grating_coupler_elliptical_te</span><span class="p">,</span>
    <span class="n">with_loopback</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-10.py">Source code</a>, <a class="reference external" href=".//routing-10.png">png</a>, <a class="reference external" href=".//routing-10.hires.png">hires.png</a>, <a class="reference external" href=".//routing-10.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-10.png" class="plot-directive" src="_images/routing-10.png"/>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a></p>
</dd>
</dl>
</dd></dl>
<p>Or can also connect to individual fibers for input and output.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gdsfactory.routing.add_fiber_single.add_fiber_single">
<span class="sig-prename descclassname"><span class="pre">gdsfactory.routing.add_fiber_single.</span></span><span class="sig-name descname"><span class="pre">add_fiber_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component='mmi2x2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grating_coupler=functools.partial(&lt;function</span> <span class="pre">grating_coupler_elliptical_trenches&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization='te'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_angle=35)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_label=(201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fiber_spacing=50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bend=&lt;function</span> <span class="pre">bend_euler&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">straight=&lt;function</span> <span class="pre">straight&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">route_filter=&lt;function</span> <span class="pre">get_route_from_waypoints&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_input_to_output_spacing=200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optical_routing_type=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_loopback=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loopback_xspacing=50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gc_port_name='o1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_port='o1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_input_label_text_loopback_function=&lt;function</span> <span class="pre">get_input_label_text_loopback&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_input_label_text_function=&lt;function</span> <span class="pre">get_input_label_text&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_ports=functools.partial(&lt;function</span> <span class="pre">select_ports&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port_type='optical')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_section='strip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gdsfactory/routing/add_fiber_single.html#add_fiber_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gdsfactory.routing.add_fiber_single.add_fiber_single" title="Permalink to this definition">#</a></dt>
<dd><p>Returns component with grating couplers and labels on each port.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – component or component function to connect to grating couplers.</p></li>
<li><p><strong>grating_coupler</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]]]) – grating coupler instance, function or list of functions</p></li>
<li><p><strong>layer_label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – for test and measurement label</p></li>
<li><p><strong>fiber_spacing</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – between outputs</p></li>
<li><p><strong>bend</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – bend function.</p></li>
<li><p><strong>straight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – straight function.</p></li>
<li><p><strong>route_filter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – </p></li>
<li><p><strong>min_input_to_output_spacing</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – spacing from input to output fiber</p></li>
<li><p><strong>max_y0_optical</strong> – None</p></li>
<li><p><strong>with_loopback</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – True, adds loopback reference straight waveguide.</p></li>
<li><p><strong>loopback_xspacing</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – spacing from loopback xmin to component.xmin</p></li>
<li><p><strong>straight_separation</strong> – spacing between waveguides.</p></li>
<li><p><strong>list_port_labels</strong> – None, add labels to port indices in this list</p></li>
<li><p><strong>connected_port_list_ids</strong> – None # only for type 0 optical routing</p></li>
<li><p><strong>nb_optical_ports_lines</strong> – <ol class="arabic simple">
<li></li>
</ol>
</p></li>
<li><p><strong>force_manhattan</strong> – False.</p></li>
<li><p><strong>excluded_ports</strong> – list of ports to exclude.</p></li>
<li><p><strong>grating_indices</strong> – None.</p></li>
<li><p><strong>routing_method</strong> – function to ge the route.</p></li>
<li><p><strong>gc_port_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – grating coupler name.</p></li>
<li><p><strong>zero_port</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – name of the port to move to (0, 0) for the routing to work correctly.</p></li>
<li><p><strong>get_input_labels_function</strong> – function to get input labels for grating couplers.</p></li>
<li><p><strong>optical_routing_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – None: autoselection, 0: no extension.</p></li>
<li><p><strong>gc_rotation</strong> – grating_coupler rotation (deg).</p></li>
<li><p><strong>component_name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – name of component.</p></li>
<li><p><strong>cross_section</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>], <a class="reference internal" href="api.html#gdsfactory.cross_section.CrossSection" title="gdsfactory.cross_section.CrossSection"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossSection</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]) – cross_section factory.</p></li>
<li><p><strong>get_input_label_text_function</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – for the grating couplers input label</p></li>
<li><p><strong>get_input_label_text_loopback_function</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – for the loopacks input label</p></li>
<li><p><strong>kwargs</strong> – cross_section settings</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asumes</span> <span class="n">grating</span> <span class="n">coupler</span> <span class="n">has</span> <span class="n">o1</span> <span class="nb">input</span> <span class="n">port</span> <span class="n">facing</span> <span class="n">west</span> <span class="n">at</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span>
     <span class="n">___________</span>
    <span class="o">/|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
   <span class="o">/</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
<span class="n">o1</span><span class="o">|</span>  <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
   \ <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>
  <span class="o">|</span> \<span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>

  <span class="o">|</span>
 <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdsfactory</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">crossing</span><span class="p">()</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">add_fiber_single</span><span class="p">(</span>
    <span class="n">component</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
    <span class="n">optical_routing_type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">grating_coupler</span><span class="o">=</span><span class="n">gf</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">grating_coupler_elliptical_te</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//routing-11.py">Source code</a>, <a class="reference external" href=".//routing-11.png">png</a>, <a class="reference external" href=".//routing-11.hires.png">hires.png</a>, <a class="reference external" href=".//routing-11.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/routing-11.png" class="plot-directive" src="_images/routing-11.png"/>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="api.html#gdsfactory.component.Component" title="gdsfactory.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a></p>
</dd>
</dl>
</dd></dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="components.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Components</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="component_intro.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Workflow</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019, PsiQ
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Routing</a><ul>
<li><a class="reference internal" href="#module-gdsfactory.routing.get_route">get_route</a></li>
<li><a class="reference internal" href="#module-gdsfactory.routing.get_route_from_steps">get_route_from_steps</a></li>
<li><a class="reference internal" href="#get-bundle">get_bundle</a></li>
<li><a class="reference internal" href="#get-bundle-from-steps">get_bundle_from_steps</a></li>
<li><a class="reference internal" href="#route-ports-to-side">route_ports_to_side</a></li>
<li><a class="reference internal" href="#get-bundle-from-waypoints">get_bundle_from_waypoints</a></li>
<li><a class="reference internal" href="#get-bundle-path-length-match">get_bundle_path_length_match</a></li>
<li><a class="reference internal" href="#add-fiber-array-add-fiber-single">add_fiber_array / add_fiber_single</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    </body>
</html>